  select distinct right(RefNumber,2) ,substring(refnumber,9,13), bmr.CreateTime	from bc_basemoneyreceived bmr	inner join bc_account a on a.id = bmr.accountid	inner join bc_invoiceitem ii on ii.InstallmentNumber = cast(right(bmr.RefNumber,2) as INT)	inner join bc_policyperiod pp on pp.ID = ii.PolicyPeriodID 	where bmr.subtype in (3,4)	and refnumber is not null	and ii.PaidAmount = 0	and (II.retired = 0 or pp.policynumber in (5003110010318,5003110112731, 5003110030648))	and pp.policynumber not in (5009110003454)	and pp.cancelstatus <> 3	and pp.PolicyNumber = substring(bmr.refnumber,9,13)	and bmr.CreateTime > '2017-11-01 00:00:00'	and bmr.reversaldate is null	and bmr.retired = 0	and ISNUMERIC(right(bmr.RefNumber,2)) = 1